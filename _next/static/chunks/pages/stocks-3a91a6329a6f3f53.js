(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[170],{1919:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return Z}});var r=a(7294),n=a(6508),s=a(2370),o=a(515),l=a(7818),c=a(7536),i=a(7538);var u=[{symbol:"AAPL",lots:[{id:"a180c2da-7db5-4326-9d8d-29259bf0d004",shares:6,buyDate:new Date(new Date("2021-04-19T00:00:00+00:00")),buyPrice:124,buyBrokerage:0,soldDate:void 0,soldPrice:void 0,soldBrokerage:void 0},{id:"41705304-bf6d-46cd-bb69-5c60745dd222",shares:3,buyDate:new Date(new Date("2020-02-06T00:00:00+00:00")),buyPrice:86,buyBrokerage:0,soldDate:void 0,soldPrice:void 0,soldBrokerage:void 0}],language:"en-US",region:"US",quoteType:"EQUITY",quoteSourceName:"Delayed Quote",triggerable:!0,currency:"USD",marketState:"CLOSED",shortName:"Apple Inc.",firstTradeDateMilliseconds:3454794e5,fiftyTwoWeekLowChangePercent:.5280097,priceHint:2,postMarketChangePercent:.08447029,postMarketTime:1640998796,postMarketPrice:177.72,postMarketChange:.1499939,regularMarketChange:-.6299896,regularMarketChangePercent:-.35352954,regularMarketTime:1640984403,regularMarketPrice:177.57,regularMarketDayHigh:179.23,regularMarketDayRange:"177.26 - 179.23",regularMarketDayLow:177.26,regularMarketVolume:64062281,regularMarketPreviousClose:178.2,bid:177.71,ask:177.6,bidSize:8,askSize:12,fullExchangeName:"NasdaqGS",financialCurrency:"USD",regularMarketOpen:178.085,averageDailyVolume3Month:88974236,averageDailyVolume10Day:89469180,fiftyTwoWeekLowChange:61.36001,epsTrailingTwelveMonths:5.61,epsForward:6.18,epsCurrentYear:5.74,priceEpsCurrentYear:30.935543,sharesOutstanding:164064e5,bookValue:3.841,fiftyDayAverage:162.0976,fiftyDayAverageChange:15.472412,fiftyDayAverageChangePercent:.09545121,twoHundredDayAverage:143.95364,twoHundredDayAverageChange:33.616364,twoHundredDayAverageChangePercent:.23352215,marketCap:2913284653056,forwardPE:28.733011,priceToBook:46.23015,sourceInterval:15,exchangeDataDelayedBy:0,exchange:"NMS",longName:"Apple Inc.",messageBoardId:"finmb_24937",exchangeTimezoneName:"America/New_York",exchangeTimezoneShortName:"EST",gmtOffSetMilliseconds:-18e6,market:"us_market",esgPopulated:!1,fiftyTwoWeekRange:"116.21 - 182.13",fiftyTwoWeekHighChange:-4.5599976,fiftyTwoWeekHighChangePercent:-.025037047,fiftyTwoWeekLow:116.21,fiftyTwoWeekHigh:182.13,dividendDate:1636588800,earningsTimestamp:1635438600,earningsTimestampStart:1643144400,earningsTimestampEnd:1643662800,trailingAnnualDividendRate:.85,trailingPE:31.652407,trailingAnnualDividendYield:.004769922,averageAnalystRating:"1.8 - Buy",tradeable:!1,displayName:"Apple"},{symbol:"GOOGL",lots:[{id:"24f14409-5869-4ff9-be8a-98a6ef673060",shares:2,buyDate:new Date(new Date("2020-04-09T00:00:00+00:00")),buyPrice:1213,buyBrokerage:0,soldDate:void 0,soldPrice:void 0,soldBrokerage:void 0}],language:"en-US",region:"US",quoteType:"EQUITY",quoteSourceName:"Delayed Quote",triggerable:!0,currency:"USD",marketState:"CLOSED",shortName:"Alphabet Inc.",firstTradeDateMilliseconds:10929222e5,fiftyTwoWeekLowChangePercent:.7080597,priceHint:2,postMarketChangePercent:.102171905,postMarketTime:1640998793,postMarketPrice:2900,postMarketChange:2.959961,regularMarketChange:-26.96997,regularMarketChangePercent:-.9223625,regularMarketTime:1640984403,regularMarketPrice:2897.04,regularMarketDayHigh:2933.97,regularMarketDayRange:"2897.04 - 2933.97",regularMarketDayLow:2897.04,regularMarketVolume:906759,regularMarketPreviousClose:2924.01,bid:2898,ask:2901.52,bidSize:9,askSize:10,fullExchangeName:"NasdaqGS",financialCurrency:"USD",regularMarketOpen:2921,averageDailyVolume3Month:1518517,averageDailyVolume10Day:1224160,fiftyTwoWeekLowChange:1200.9401,epsTrailingTwelveMonths:103.805,epsForward:112.42,epsCurrentYear:108.39,priceEpsCurrentYear:26.727928,sharesOutstanding:300809984,bookValue:367.946,fiftyDayAverage:2908.6145,fiftyDayAverageChange:-11.574463,fiftyDayAverageChangePercent:-.0039793733,twoHundredDayAverage:2620.165,twoHundredDayAverageChange:276.875,twoHundredDayAverageChangePercent:.105670825,marketCap:1921705181184,forwardPE:25.769793,priceToBook:7.8735466,sourceInterval:15,exchangeDataDelayedBy:0,exchange:"NMS",longName:"Alphabet Inc.",messageBoardId:"finmb_29096",exchangeTimezoneName:"America/New_York",exchangeTimezoneShortName:"EST",gmtOffSetMilliseconds:-18e6,market:"us_market",esgPopulated:!1,fiftyTwoWeekRange:"1696.1 - 3019.33",fiftyTwoWeekHighChange:-122.29004,fiftyTwoWeekHighChangePercent:-.040502377,fiftyTwoWeekLow:1696.1,fiftyTwoWeekHigh:3019.33,dividendDate:0,earningsTimestamp:1635278400,earningsTimestampStart:1643662800,earningsTimestampEnd:1644008400,trailingAnnualDividendRate:0,trailingPE:27.908482,trailingAnnualDividendYield:0,averageAnalystRating:"1.7 - Buy",tradeable:!1,displayName:""},{symbol:"MSFT",lots:[{id:"4c7c2e1e-78f9-407c-9747-b3d3f860087f",shares:10,buyDate:new Date("2020-01-06T00:00:00+00:00"),buyPrice:148,buyBrokerage:0,soldDate:void 0,soldPrice:void 0,soldBrokerage:void 0},{id:"dfeb996b-ba02-4533-b4ef-67a8ac5a0173",shares:13,buyDate:new Date("2021-07-02T00:00:00+00:00"),buyPrice:257,buyBrokerage:0,soldDate:void 0,soldPrice:void 0,soldBrokerage:void 0}],language:"en-US",region:"US",quoteType:"EQUITY",quoteSourceName:"Nasdaq Real Time Price",triggerable:!0,currency:"USD",marketState:"CLOSED",shortName:"Microsoft Corporation",firstTradeDateMilliseconds:5111082e5,fiftyTwoWeekLowChangePercent:.58686423,priceHint:2,postMarketChangePercent:.139748,postMarketTime:1640998788,postMarketPrice:336.79,postMarketChange:.470001,regularMarketChange:-3,regularMarketChangePercent:-.8841212,regularMarketTime:1640984404,regularMarketPrice:336.32,regularMarketDayHigh:339.35,regularMarketDayRange:"335.85 - 339.35",regularMarketDayLow:335.85,regularMarketVolume:17943888,regularMarketPreviousClose:339.32,bid:336.32,ask:336.79,bidSize:13,askSize:9,fullExchangeName:"NasdaqGS",financialCurrency:"USD",regularMarketOpen:338.51,averageDailyVolume3Month:25744050,averageDailyVolume10Day:22989170,fiftyTwoWeekLowChange:124.380005,epsTrailingTwelveMonths:8.939,epsForward:10.53,epsCurrentYear:9.21,priceEpsCurrentYear:36.51683,sharesOutstanding:7507979776,bookValue:20.242,fiftyDayAverage:331.8472,fiftyDayAverageChange:4.472809,fiftyDayAverageChangePercent:.013478519,twoHundredDayAverage:287.4741,twoHundredDayAverageChange:48.845917,twoHundredDayAverageChangePercent:.16991416,marketCap:2525083729920,forwardPE:31.939222,priceToBook:16.61496,sourceInterval:15,exchangeDataDelayedBy:0,exchange:"NMS",longName:"Microsoft Corporation",messageBoardId:"finmb_21835",exchangeTimezoneName:"America/New_York",exchangeTimezoneShortName:"EST",gmtOffSetMilliseconds:-18e6,market:"us_market",esgPopulated:!1,fiftyTwoWeekRange:"211.94 - 349.67",fiftyTwoWeekHighChange:-13.350006,fiftyTwoWeekHighChangePercent:-.03817887,fiftyTwoWeekLow:211.94,fiftyTwoWeekHigh:349.67,dividendDate:1646870400,earningsTimestamp:1635264756,earningsTimestampStart:1643021940,earningsTimestampEnd:1643371200,trailingAnnualDividendRate:2.3,trailingPE:37.623894,trailingAnnualDividendYield:.006778262,averageAnalystRating:"1.7 - Buy",tradeable:!1,displayName:"Microsoft"},{symbol:"VWS.CO",lots:[{id:"5672c6b2-ff51-4afc-bb9e-8250a20563a6",shares:100,buyDate:new Date("2020-04-09T00:00:00+00:00"),buyPrice:130,buyBrokerage:0,soldDate:void 0,soldPrice:void 0,soldBrokerage:void 0}],language:"en-US",region:"US",quoteType:"EQUITY",quoteSourceName:"Delayed Quote",triggerable:!0,currency:"DKK",marketState:"CLOSED",shortName:"Vestas Wind Systems A/S",firstTradeDateMilliseconds:957942e6,fiftyTwoWeekLowChangePercent:.17577891,priceHint:2,postMarketChangePercent:0,postMarketTime:0,postMarketPrice:0,postMarketChange:0,regularMarketChange:4.5,regularMarketChangePercent:2.3017902,regularMarketTime:1640879978,regularMarketPrice:200,regularMarketDayHigh:200.4,regularMarketDayRange:"195.25 - 200.4",regularMarketDayLow:195.25,regularMarketVolume:1908374,regularMarketPreviousClose:195.5,bid:200.1,ask:0,bidSize:0,askSize:0,fullExchangeName:"Copenhagen",financialCurrency:"EUR",regularMarketOpen:195.5,averageDailyVolume3Month:2966962,averageDailyVolume10Day:2299444,fiftyTwoWeekLowChange:29.899994,epsTrailingTwelveMonths:5.24,epsForward:.6,epsCurrentYear:.42,priceEpsCurrentYear:476.1905,sharesOutstanding:1009059968,bookValue:4.689,fiftyDayAverage:223.41,fiftyDayAverageChange:-23.410004,fiftyDayAverageChangePercent:-.104784936,twoHundredDayAverage:238.20094,twoHundredDayAverageChange:-38.200943,twoHundredDayAverageChangePercent:-.16037276,marketCap:201812000768,forwardPE:333.3333,priceToBook:42.653015,sourceInterval:15,exchangeDataDelayedBy:0,exchange:"CPH",longName:"Vestas Wind Systems A/S",messageBoardId:"finmb_36246",exchangeTimezoneName:"Europe/Copenhagen",exchangeTimezoneShortName:"CET",gmtOffSetMilliseconds:36e5,market:"dk_market",esgPopulated:!1,fiftyTwoWeekRange:"170.1 - 321.0",fiftyTwoWeekHighChange:-121,fiftyTwoWeekHighChangePercent:-.37694705,fiftyTwoWeekLow:170.1,fiftyTwoWeekHigh:321,dividendDate:0,earningsTimestamp:1643799540,earningsTimestampStart:1643799540,earningsTimestampEnd:1643799540,trailingAnnualDividendRate:.228,trailingPE:38.167942,trailingAnnualDividendYield:.0011662404,averageAnalystRating:"4.0 - Underperform",tradeable:!1,displayName:""}];const d=`${i.NS}/${i.tW}`;async function m(...e){if(i.xh)return Promise.resolve(u);const t=`${i.NS}/${i.tW}/stock`,a=await fetch(`${t}?symbols=${e.join(",")}`,{method:"GET"}),r=await a.json();if(r.error)throw new Error(r.error);return r??[]}var g,y=a(7384),f=new Uint8Array(16);function p(){if(!g&&!(g="undefined"!==typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!==typeof msCrypto&&"function"===typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return g(f)}var k=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;for(var h=function(e){return"string"===typeof e&&k.test(e)},b=[],E=0;E<256;++E)b.push((E+256).toString(16).substr(1));var D=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=(b[e[t+0]]+b[e[t+1]]+b[e[t+2]]+b[e[t+3]]+"-"+b[e[t+4]]+b[e[t+5]]+"-"+b[e[t+6]]+b[e[t+7]]+"-"+b[e[t+8]]+b[e[t+9]]+"-"+b[e[t+10]]+b[e[t+11]]+b[e[t+12]]+b[e[t+13]]+b[e[t+14]]+b[e[t+15]]).toLowerCase();if(!h(a))throw TypeError("Stringified UUID is invalid");return a};var v=function(e,t,a){var r=(e=e||{}).random||(e.rng||p)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){a=a||0;for(var n=0;n<16;++n)t[a+n]=r[n];return t}return D(r)};const C="stocks_state",w=(0,r.createContext)({state:S(),dispatch:e=>{}});function T(e,t){return(0,y.n)(C,N)(e,t)}function S(){const e=(0,y.v)(C,{stocks:[],preferredCurrency:"usd",currencyRates:{usd:{}}});for(const t of Object.keys(e.stocks))for(const a of e.stocks[t].lots)a.buyDate=new Date(Date.parse(a.buyDate)),a.soldDate=a.soldDate?new Date(Date.parse(a.soldDate)):void 0;return e}function N(e,t){switch(t.type){case"ADD STOCK":return e.stocks.find((e=>e.symbol===t.stock.symbol))?e:{...e,stocks:e.stocks.concat(t.stock)};case"DELETE STOCK":return{...e,stocks:e.stocks.filter((e=>e.symbol!==t.symbol))};case"UPDATE STOCKS":return console.log(t.stocks),{...e,stocks:e.stocks.map((e=>{const a=t.stocks.find((t=>t.symbol===e.symbol));return{...e,...a,lots:e.lots}}))};case"SET STOCKS":return{...e,stocks:t.stocks.map((e=>({...e,lots:e.lots??[]})))};case"ADD LOT":{const a={id:t.lotId??v(),shares:0,buyDate:new Date,buyPrice:e.stocks.find((e=>e.symbol===t.symbol))?.regularMarketPrice??0,buyBrokerage:0};return{...e,stocks:e.stocks.map((e=>e.symbol!==t.symbol?e:{...e,lots:e.lots.concat(a)}))}}case"DELETE LOT":return{...e,stocks:e.stocks.map((e=>e.symbol!==t.symbol?e:{...e,lots:e.lots.filter((e=>e.id!==t.id))}))};case"EDIT LOT":return{...e,stocks:e.stocks.map((e=>e.symbol!==t.symbol?e:{...e,lots:e.lots.filter((e=>e.id!==t.lot.id)).concat(t.lot)}))};default:return console.warn("action not implemented"),e}}function P(){return P=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},P.apply(this,arguments)}var x=()=>{const{dispatch:e}=(0,r.useContext)(w),[t,a]=(0,r.useState)(!1),{register:n,handleSubmit:o,formState:{errors:i},reset:u}=(0,c.cI)(),g=(0,r.useCallback)((async t=>{const a=await m(t.symbol);0===a.length?alert(`Stock with symbol '${t.symbol}' was not found`):(await async function(e){await fetch(`${d}/stock/tracked`,{method:"POST",credentials:"include",body:e}).then((()=>console.log(`Stock tracked: ${e}`))).catch((e=>console.log(e)))}(t.symbol),e({type:"ADD STOCK",stock:{...a[0],symbol:t.symbol,lots:[]}}),u())}),[e,u]);return r.createElement(r.Fragment,null,r.createElement("button",{className:"btn btn-primary space-x-2",onClick:()=>a(!0)},r.createElement(s.RWZ,{className:"inline"}),r.createElement("span",{className:"align-middle"},"Add symbol")),r.createElement(l.u_,{isOpen:t,onDismiss:()=>a(!1)},r.createElement("div",{className:"p-4 rounded bg-gray-300 dark:bg-gray-700"},r.createElement("h3",{className:"text-lg font-bold pb-4"},"Add symbol"),r.createElement("form",{onSubmit:o(g),className:"space-y-4"},r.createElement("fieldset",{className:"space-y-2"},r.createElement(l.II,P({placeholder:"AAPL, MSFT...",label:"Symbol"},n("symbol",{required:!0}),{errorMessage:i.symbol&&"Please provide a symbol to add"}))),r.createElement(l.qO,null,r.createElement(l.zx,{type:"submit",className:"btn btn-primary ml-4 order-last"},"Add"),r.createElement(l.zx,{buttonType:"Transparent",onClick:()=>a(!1)},"Cancel"))))))};function M(...e){return e.reduce(((e,t)=>e+t),0)}function A(e){return M(...e.lots.map((e=>e.shares)))}function O(e){const t=A(e);return M(...e.lots.map((e=>e.shares*e.buyPrice)))/t}function L(e,t,a){const r=A(e),n=O(e);return(0,o.fK)(r*e.regularMarketPrice-r*n,t?.usd,e.currency,a)}var K=()=>{const{state:e,dispatch:t}=(0,r.useContext)(w),a=(0,r.useCallback)((async()=>{try{const a=await m(...e.stocks.map((e=>e.symbol)));t({type:"UPDATE STOCKS",stocks:a})}catch(a){console.error(a)}}),[e.stocks,t]);return r.createElement(l.zx,{onClick:a,className:"btn btn-primary space-x-2"},r.createElement(s.A$d,{"aria-label":"Reload current stock prices",className:"inline"}),r.createElement("span",{className:"align-middle"},"Refresh stocks"))},W=a(1635),B=a(6645);function R(){return R=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},R.apply(this,arguments)}var H=({stock:e,lot:t})=>{const{dispatch:a}=(0,r.useContext)(w),{values:{currencyRates:l,preferredDisplayCurrency:i}}=(0,r.useContext)(n.Z),{register:u,handleSubmit:m,watch:g}=(0,c.cI)({mode:"onChange",defaultValues:{...t,buyDate:(0,B.p)(t.buyDate)}}),y=(0,r.useCallback)((async t=>{if(""===t.buyDate)return;const r={shares:Number(t.shares),buyPrice:Number(t.buyPrice),buyDate:new Date(Date.parse(t.buyDate.toString())),buyBrokerage:0};await async function(e,t){await fetch(`${d}/stock/lot/${e}`,{method:"PUT",credentials:"include",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})}(t.id,r),a({type:"EDIT LOT",symbol:e.symbol,lot:{...r,id:t.id}})}),[a,e.symbol]),f=(0,r.useCallback)((async()=>{await async function(e){await fetch(`${d}/stock/lot/${e}`,{method:"DELETE",credentials:"include",mode:"cors",headers:{"Content-Type":"application/json"}})}(t.id),a({type:"DELETE LOT",symbol:e.symbol,id:t.id})}),[a,t.id,e.symbol]),p=(0,o.sL)(e.currency,i,l.usd),k=g("shares")*e.regularMarketPrice,h=g("buyPrice")*g("shares"),b=k-h;return r.createElement("tr",{className:"odd:bg-gray-200 dark:odd:bg-gray-600"},r.createElement("td",{colSpan:3},r.createElement("form",{onChange:m(y),className:"flex w-full flex-row justify-evenly"},r.createElement("input",R({type:"date"},u("buyDate"),{className:"bg-transparent"})),r.createElement("input",R({type:"number"},u("shares"),{className:"w-20 bg-transparent text-center"})),r.createElement("input",R({type:"number"},u("buyPrice"),{className:"w-20 bg-transparent text-center"})))),r.createElement("td",{className:"text-right"},(0,o.xG)(p(k),i)),r.createElement("td",{className:`${(0,W.y)(b)} flex flex-col text-right`},r.createElement("span",null,(0,o.xG)(p(b),i)),r.createElement("span",null,(100*(k/h-1)).toFixed(2)," %")),r.createElement("td",{className:"pl-4"},r.createElement("button",{onClick:f},r.createElement(s.BFV,{className:"text-red-700 dark:text-red-500",size:24}))))};var U=({lots:e,stock:t})=>{const{dispatch:a}=(0,r.useContext)(w),n=(0,r.useCallback)((async()=>{const e=await(r={symbol:t.symbol,shares:0,buyDate:new Date,buyPrice:0,buyBrokerage:0},fetch(`${d}/stock/lot`,{method:"POST",credentials:"include",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)}).then((e=>e.json())));var r;a({type:"ADD LOT",symbol:t.symbol,lotId:e})}),[a,t]);return r.createElement(r.Fragment,null,r.createElement("h3",{className:"text-center text-2xl text-green-700 dark:text-green-400"},"Lots for ",t.displayName??t.symbol),r.createElement("div",{className:"bg-gray-300 dark:bg-gray-700 rounded shadow mx-8"},r.createElement("table",{className:"w-full"},r.createElement("thead",null,r.createElement("tr",null,r.createElement("th",null,"Buy date"),r.createElement("th",null,"Shares"),r.createElement("th",null,"Buy price"),r.createElement("th",null,"Market value"),r.createElement("th",null,"Total gain"))),r.createElement("tbody",null,e.map((e=>r.createElement(H,{key:e.id,lot:e,stock:t}))))),r.createElement("div",{className:"p-4"},r.createElement(l.zx,{onClick:n,className:"space-x-2 btn btn-primary"},r.createElement(s.RWZ,{className:"inline"}),r.createElement("span",{className:"align-middle"},"Add lot")))))};var V=({stock:e})=>{const{values:{preferredDisplayCurrency:t,currencyRates:a}}=(0,r.useContext)(n.Z),s=(0,o.sL)(e.currency,t,a.usd),l=A(e),c=O(e),i=c*l,u=e.regularMarketPrice*l,d=L(e,a,t),m=100*(u/i-1),[g,y]=(0,r.useState)(!1);return r.createElement(r.Fragment,null,r.createElement("tr",{className:"relative w-full bg-gray-200 text-right dark:bg-gray-800"},r.createElement("td",{className:"px-2 text-left"},e.symbol),r.createElement("td",{className:"px-2"},(0,o.xG)(e.regularMarketPrice,e.currency)),r.createElement("td",{className:"px-0"},(0,o.xG)(s(u),t)),r.createElement("td",null,l),r.createElement("td",{className:`px-2 ${(0,W.y)(c)}`},(0,o.xG)(c,e.currency)),r.createElement("td",{className:`px-2 ${(0,W.y)(d)}`},r.createElement("span",null,(0,o.xG)(d,t))),r.createElement("td",{className:`px-1 ${(0,W.y)(m)}`},r.createElement("span",{className:isNaN(m)?"hidden":""},m.toFixed(2)," %")),r.createElement(I,{stock:e,setShowLots:y})),r.createElement("tr",null,r.createElement("td",{colSpan:7,className:"p-0 pb-4 "+(g?"":"hidden")},r.createElement(U,{lots:e.lots,stock:e}))))};const I=({stock:e,setShowLots:t})=>{const{dispatch:a}=(0,r.useContext)(w),n=(0,r.useCallback)((()=>{a({type:"DELETE STOCK",symbol:e.symbol})}),[a,e.symbol]);return r.createElement("td",{className:"flex h-full flex-row justify-end space-x-2 px-4"},r.createElement("button",{onClick:()=>t((e=>!e)),className:"hover:cursor-pointer"},r.createElement(s.XSk,{size:24})),r.createElement("button",{onClick:n,className:"hover:cursor-pointer"},r.createElement(s.BFV,{className:"text-red-500",size:24})))};var _=({stocks:e})=>{const{values:{preferredDisplayCurrency:t,currencyRates:a}}=(0,r.useContext)(n.Z),s=(0,r.useMemo)((()=>M(...e.flatMap((e=>e.lots.map((r=>(0,o.fK)(e.regularMarketPrice*r.shares,a.usd,e.currency,t))))))),[a.usd,t,e]),l=(0,r.useMemo)((()=>M(...e.flatMap((e=>e.lots.map((r=>(0,o.fK)(e.regularMarketPrice*r.shares-r.buyPrice*r.shares,a.usd,e.currency,t))))))),[a.usd,t,e]),c=100*(s/(s-l)-1);return r.createElement("tr",{className:"text-right font-bold dark:text-purple-400"},r.createElement("td",null),r.createElement("td",null),r.createElement("td",null,(0,o.xG)(s,t)),r.createElement("td",null),r.createElement("td",null),r.createElement("td",null,(0,o.xG)(l,t)),r.createElement("td",null,c.toFixed(2)," %"))};var z=()=>{const[e,t]=(0,r.useReducer)(T,S());return(0,r.useEffect)((()=>{(i.xh?Promise.resolve(u):fetch(`${d}/stock/tracked`,{credentials:"include"}).then((async e=>await e.json())).then((e=>e.map((e=>({...e,lots:e.lots.map((e=>({...e,buyDate:new Date(Date.parse(e.buyDate)),soldDate:e.soldDate?new Date(Date.parse(e.soldDate)):void 0})))})))))).then((e=>t({type:"SET STOCKS",stocks:e}))).then((async()=>{const a=await m(...e.stocks.map((e=>e.symbol)));t({type:"UPDATE STOCKS",stocks:a})}))}),[]),r.createElement(w.Provider,{value:{state:e,dispatch:t}},r.createElement("h2",{className:"px-4 py-4 text-xl"},"Stocks"),r.createElement(G,{stocks:e.stocks}),r.createElement(F,null))};const G=({stocks:e})=>{const{values:{currencyRates:t,preferredDisplayCurrency:a}}=(0,r.useContext)(n.Z),[s,l]=(0,r.useState)(),[c,i]=(0,r.useState)(!1);return r.createElement("div",{className:"overflow-x-scroll"},r.createElement("table",{className:"w-full"},r.createElement("thead",null,r.createElement($,{sortKey:s,ascending:c,setAscending:i,setSortKey:l})),r.createElement("tbody",null,e.sort(function(e,t,a,r){if(!t)return()=>0;const n=t=>(0,o.fK)(t.regularMarketPrice,e?.usd,t.currency,r);return(s,l)=>{let c=0;switch(t){case"Symbol":c=s.symbol.localeCompare(l.symbol);break;case"Gain":c=L(s,e,r)-L(l,e,r);break;case"Gain percentage":const t=e=>{const t=A(e),a=O(e)*t;return 100*(e.regularMarketPrice*t/a-1)};c=t(s)-t(l);break;case"Average price":c=(0,o.fK)(O(s),e.usd,s.currency,r)-(0,o.fK)(O(l),e.usd,l.currency,r);break;case"Current price":c=n(s)-n(l);break;case"Total shares":c=A(s)-A(l);break;case"Total value":c=n(s)*A(s)-n(l)*A(l)}return c*(a?1:-1)}}(t,s,c,a)).map((e=>r.createElement(V,{key:e.symbol,stock:e})))),r.createElement("tfoot",null,r.createElement(_,{stocks:e}))))},$=({sortKey:e,ascending:t,setAscending:a,setSortKey:n})=>{const s=(0,r.useCallback)((t=>()=>{e===t?a((e=>!e)):n(t)}),[n,a,e]);return r.createElement("tr",{className:"align-bottom text-sm text-gray-600 dark:text-gray-400"},r.createElement(Y,{sort:s,currentSortKey:e,sortKey:"Symbol",ascending:t},"Symbol"),r.createElement(Y,{sort:s,currentSortKey:e,sortKey:"Current price",ascending:t},"Price"),r.createElement(Y,{sort:s,currentSortKey:e,sortKey:"Total value",ascending:t},"Total value"),r.createElement(Y,{sort:s,currentSortKey:e,sortKey:"Total shares",ascending:t},"Shares"),r.createElement(Y,{sort:s,currentSortKey:e,sortKey:"Average price",ascending:t},"Avg price"),r.createElement(Y,{sort:s,currentSortKey:e,sortKey:"Gain",ascending:t},"Gain"),r.createElement(Y,{sort:s,currentSortKey:e,sortKey:"Gain percentage",ascending:t},"Percentage"))},F=()=>r.createElement("div",{className:"flex justify-between p-4"},r.createElement(x,null),r.createElement(K,null)),Y=({sort:e,children:t,currentSortKey:a,sortKey:n,ascending:s})=>r.createElement("th",null,r.createElement("button",{onClick:e(n),className:"whitespace-nowrap rounded-sm ring-red-800 focus:ring-1 dark:ring-red-600"},t,n===a&&r.createElement(j,{ascending:s}))),j=({ascending:e})=>r.createElement(r.Fragment,null,e?r.createElement(s.lmx,{className:"inline"}):r.createElement(s.Gal,{className:"inline"}));var q=a(447);var Z=()=>r.createElement(r.Fragment,null,r.createElement(q.Z,{title:"Stocks"}),r.createElement(z,null))},447:function(e,t,a){"use strict";var r=a(9008),n=a.n(r),s=a(7294);t.Z=({title:e})=>s.createElement(n(),null,s.createElement("title",null,e," | Finance"))},1635:function(e,t,a){"use strict";function r(e){return e>0?n.positiveColor:e<0?n.negativeColor:""}a.d(t,{y:function(){return r}});const n={positiveColor:"text-green-700 dark:text-green-500",negativeColor:"text-red-700 dark:text-red-500"}},515:function(e,t,a){"use strict";a.d(t,{CV:function(){return u},fK:function(){return l},oB:function(){return s},p3:function(){return n},sL:function(){return i},xG:function(){return o}});var r=a(7294);function n(e){return Number.parseFloat(e.toString().replace(/[,a-zA-Z]/g,""))}const s=Intl.NumberFormat(void 0,{style:"currency",currency:"DKK",currencyDisplay:"code"});function o(e,t){if(!e||Number.isNaN(e))return"0";const a=t=>e.toLocaleString(void 0,{style:"currency",currency:t,currencyDisplay:"code"});try{return a(t??"USD")}catch(r){return r instanceof RangeError&&r.message.startsWith("Invalid currency code")&&t?a("USD").replace("USD",t):e.toString()}}function l(e,t,a,r){return e*c(t,a,r)}function c(e,t,a){const r="usd";return t=t?.toLowerCase(),a=a?.toLowerCase(),e=e,t&&a&&t!==a?t===r?a in e?e[a]:1:a===r?t in e?1/e[t]:1:c(e,t,r)*c(e,r,a):1}function i(e,t,a){return(0,r.useCallback)((r=>l(r,a,e,t)),[e,a,t])}function u(e){return Object.keys(e).sort().reduce(((t,a)=>(t[a]=e[a],t)),{})}},6645:function(e,t,a){"use strict";function r(e){const t=e.getFullYear();let a=""+(e.getMonth()+1),r=""+e.getDate();return a.length<2&&(a="0"+a),r.length<2&&(r="0"+r),[t,a,r].join("-")}a.d(t,{p:function(){return r}})},2337:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/stocks",function(){return a(1919)}])}},function(e){e.O(0,[536,888,774,179],(function(){return t=2337,e(e.s=t);var t}));var t=e.O();_N_E=t}]);