(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{6359:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return L}});var n=a(7294),r=a(7818),c=a(6508),s=a(7536),l=a(2370);function o(){return o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},o.apply(this,arguments)}var u=({addAccount:e})=>{const[t,a]=(0,n.useState)(!1),{register:u,handleSubmit:m,reset:d,formState:{errors:i}}=(0,s.cI)(),p=(0,n.useCallback)((()=>a(!1)),[a]),D=(0,n.useCallback)((t=>{e(t),d(),p()}),[e,p,d]),y=(0,n.useId)(),{values:{currencyRates:E,preferredDisplayCurrency:f}}=(0,n.useContext)(c.Z);return n.createElement(n.Fragment,null,n.createElement("button",{onClick:()=>a((e=>!e)),className:"btn btn-primary space-x-2"},n.createElement(l.RWZ,{className:"inline"}),n.createElement("span",{className:"align-middle"},"Add account")),n.createElement(r.u_,{isOpen:t,onDismiss:p},n.createElement("form",{onSubmit:m(D),className:"rounded bg-indigo-500 p-4 dark:bg-indigo-900"},n.createElement("div",{className:"pb-4"},n.createElement("h2",{className:"text-lg text-gray-700 dark:text-gray-200"},"Add new account"),n.createElement("fieldset",{className:"space-y-2"},n.createElement(r.II,o({placeholder:"Savings, Investments...",label:"Name"},u("name",{required:!0}),{errorMessage:i.name&&"Please provide a name for your account"})),n.createElement("label",{className:"flex flex-col space-y-2"},n.createElement("span",{className:"modal-form-label"},"Account type"),n.createElement("select",o({className:"modal-select"},u("type",{required:!0})),n.createElement("option",{value:"Cash"},"Cash"),n.createElement("option",{value:"Investment"},"Investment"))),n.createElement("label",{htmlFor:y,className:"flex flex-col space-y-2"},n.createElement("span",{className:"modal-form-label"},"Account currency"),n.createElement("select",o({id:y,defaultValue:f,className:"modal-select"},u("currency",{required:!0})),Object.keys(E.usd).map((e=>e.toUpperCase())).map((e=>n.createElement("option",{key:e,value:e},e))))))),n.createElement(r.qO,null,n.createElement(r.zx,{buttonType:"Transparent",onClick:p},"Cancel"),n.createElement(r.zx,{type:"submit"},"Add")))))},m=a(6645),d=a(515),i=a(7384);const p=(0,n.createContext)({state:{accounts:[],entries:{}},dispatch:e=>{}});function D(e,t){return(0,i.n)("account_state",y)(e,t)}function y(e,t){switch(t.type){case"RESET":return{accounts:[],entries:{}};case"LOAD STATE":return{...t.state,accounts:t.state.accounts.sort(((e,t)=>e.sortKey-t.sortKey))};case"ADD ACCOUNT":return{...e,accounts:e.accounts.concat(t.account)};case"ADD ENTRY":return e.entries[t.date]={},{...e};case"EDIT ENTRY FOR ACCOUNT":return e.entries[t.key][t.name]=t.value,e.entries=(0,d.CV)(e.entries),{...e};case"DELETE ENTRY":return delete e.entries[t.date],{...e,entries:e.entries};case"SORT ACCOUNTS":return{...e,accounts:e.accounts.map((e=>({...e,sortKey:t.order.find((t=>t.id===e.id))?.sortKey??0}))).sort(((e,t)=>e.sortKey-t.sortKey))};default:return console.warn(`action type not handled: ${JSON.stringify(t)}`),e}}function E(){return E=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},E.apply(this,arguments)}const f=(0,n.memo)((()=>{const{dispatch:e}=(0,n.useContext)(p),[t,a]=(0,n.useState)(!1),c=(0,n.useCallback)((()=>a(!1)),[a]),{register:l,handleSubmit:o}=(0,s.cI)(),u=o((({date:t})=>{e({type:"ADD ENTRY",date:t}),c()}));return n.createElement(n.Fragment,null,n.createElement(r.zx,{buttonType:"Primary",onClick:()=>a(!0)},"Add entry"),n.createElement(r.u_,{isOpen:t,onDismiss:c},n.createElement("form",{onSubmit:u},n.createElement("div",{className:"p-4"},n.createElement("h2",{className:"text-lg text-gray-700 dark:text-gray-400"},"Add new entry on date"),n.createElement(r.II,E({type:"date",className:"m-4"},l("date")))),n.createElement(r.qO,null,n.createElement(r.zx,{buttonType:"Primary",type:"submit"},"Add")))))}));f.displayName="AddEntryModal";var w=f,N=a(7538);var x=[{entries:[{date:new Date(Date.parse("2021-09-01")),amount:81325},{date:new Date(Date.parse("2021-11-01")),amount:89283},{date:new Date(Date.parse("2021-08-01")),amount:86219},{date:new Date(Date.parse("2021-10-01")),amount:59171},{date:new Date(Date.parse("2021-05-01")),amount:29615},{date:new Date(Date.parse("2021-04-01")),amount:49465},{date:new Date(Date.parse("2021-06-01")),amount:49589},{date:new Date(Date.parse("2021-12-01")),amount:89332},{date:new Date(Date.parse("2021-07-01")),amount:44555},{date:new Date(Date.parse("2022-01-01")),amount:89338}],id:"519486d6-41c1-4368-b6ef-678a513f6d77",name:"Cash 1",type:"Cash",currency:"USD",sortKey:0},{entries:[{date:new Date(Date.parse("2021-06-01")),amount:40259.18},{date:new Date(Date.parse("2021-11-01")),amount:5218.3},{date:new Date(Date.parse("2021-04-01")),amount:6079.73},{date:new Date(Date.parse("2021-09-01")),amount:5129},{date:new Date(Date.parse("2022-01-01")),amount:5271.17},{date:new Date(Date.parse("2021-05-01")),amount:6254.18},{date:new Date(Date.parse("2021-07-01")),amount:40280.91},{date:new Date(Date.parse("2021-12-01")),amount:5218.3},{date:new Date(Date.parse("2021-08-01")),amount:5129},{date:new Date(Date.parse("2021-10-01")),amount:5218.3}],id:"b1bb265c-1f43-4c55-be89-d45d5980f6c9",name:"Cash 2",type:"Cash",currency:"USD",sortKey:1},{entries:[{date:new Date(Date.parse("2021-11-01")),amount:69239.74},{date:new Date(Date.parse("2021-10-01")),amount:84239.74},{date:new Date(Date.parse("2021-08-01")),amount:89239.74},{date:new Date(Date.parse("2021-07-01")),amount:87239.74},{date:new Date(Date.parse("2021-12-01")),amount:57266.74},{date:new Date(Date.parse("2021-06-01")),amount:72239.74},{date:new Date(Date.parse("2021-04-01")),amount:42240.63},{date:new Date(Date.parse("2021-05-01")),amount:82239.74},{date:new Date(Date.parse("2021-09-01")),amount:94239.74},{date:new Date(Date.parse("2022-01-01")),amount:52268.55}],id:"409d4daf-1e82-41e6-868f-10f7b07e4eea",name:"Cash 3",type:"Cash",currency:"USD",sortKey:1},{entries:[{date:new Date(Date.parse("2021-09-01")),amount:317366},{date:new Date(Date.parse("2022-01-01")),amount:407768},{date:new Date(Date.parse("2021-04-01")),amount:208656},{date:new Date(Date.parse("2021-06-01")),amount:230487},{date:new Date(Date.parse("2021-11-01")),amount:393617},{date:new Date(Date.parse("2021-08-01")),amount:328161},{date:new Date(Date.parse("2021-10-01")),amount:346711},{date:new Date(Date.parse("2021-05-01")),amount:230433},{date:new Date(Date.parse("2021-12-01")),amount:427277},{date:new Date(Date.parse("2021-07-01")),amount:254852}],id:"35814c7b-c6c0-4d42-9999-c6a3bb5fabe5",name:"Invest 1",type:"Investment",currency:"USD",sortKey:1},{entries:[{date:new Date(Date.parse("2021-12-01")),amount:82},{date:new Date(Date.parse("2021-05-01")),amount:240072},{date:new Date(Date.parse("2022-01-01")),amount:10071},{date:new Date(Date.parse("2021-07-01")),amount:200072},{date:new Date(Date.parse("2021-10-01")),amount:50072},{date:new Date(Date.parse("2021-08-01")),amount:90072},{date:new Date(Date.parse("2021-04-01")),amount:260072},{date:new Date(Date.parse("2021-11-01")),amount:30072},{date:new Date(Date.parse("2021-06-01")),amount:220072},{date:new Date(Date.parse("2021-09-01")),amount:70072}],id:"89cc16a3-1940-4fb3-bb78-759ede40006a",name:"Invest 2",type:"Investment",currency:"USD",sortKey:1},{entries:[{date:new Date(Date.parse("2021-11-01")),amount:6796.32},{date:new Date(Date.parse("2021-05-01")),amount:4902.71},{date:new Date(Date.parse("2021-08-01")),amount:4354.32},{date:new Date(Date.parse("2021-09-01")),amount:6578.02},{date:new Date(Date.parse("2021-12-01")),amount:7363.61},{date:new Date(Date.parse("2021-07-01")),amount:3959.97},{date:new Date(Date.parse("2021-10-01")),amount:5821.36},{date:new Date(Date.parse("2022-01-01")),amount:6041.41},{date:new Date(Date.parse("2021-04-01")),amount:82},{date:new Date(Date.parse("2021-06-01")),amount:4630.42}],id:"d05d7e7c-120c-4d15-8f79-14bcbf24c353",name:"Invest 3",type:"Investment",currency:"USD",sortKey:1}];var b=a(7145),v=a.n(b),g=a(8493),h=a(6963),C=a(9272),k=a(9294);var O=({id:e,type:t,index:a,move:r,children:c,className:s})=>{const l=(0,n.useRef)(null),[{handlerId:o},u]=(0,C.L)({accept:t,collect:e=>({handlerId:e.getHandlerId()}),hover(e,t){if(!l.current)return;const n=e.index,c=a;if(n===c)return;const s=l.current?.getBoundingClientRect(),o=(s.bottom-s.top)/2,u=t.getClientOffset().y-s.top;n<c&&u<o||n>c&&u>o||(r(n,c),e.index=c)}},[a]),[{isDragging:m},d]=(0,k.c)((()=>({type:t,item:()=>({id:e,index:a}),collect:e=>({isDragging:!!e.isDragging()})})),[a]);return d(u(l)),n.createElement("li",{ref:l,"data-handler-id":o,className:`cursor-move ${m?"opacity-25":""} ${s||""}`},c)};var S=function({typeIdentifier:e,items:t,setItems:a,children:r,className:c}){const s=(0,n.useCallback)(((e,t)=>{a((a=>v()(a,{$splice:[[e,1],[t,0,a[e]]]})))}),[a]);return n.createElement(g.W,{backend:h.PD},n.createElement("ol",null,t.map(((t,a)=>n.createElement(O,{key:t.id,id:t.id,index:a,move:s,type:e,className:c},r(t))))))};var T=()=>n.createElement("svg",{className:"h-5 w-5 animate-spin text-black dark:text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},n.createElement("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),n.createElement("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"}));const A=({account:e})=>n.createElement("div",null,e.name);var I=()=>{const{state:{accounts:e},dispatch:t}=(0,n.useContext)(p),[a,c]=(0,n.useState)(!1),[s,o]=(0,n.useState)("NONE"),[u,m]=(0,n.useState)((0,n.useMemo)((()=>e),[e])),d=(0,n.useCallback)((e=>n.createElement(A,{account:e})),[]),i=(0,n.useCallback)((async()=>{try{o("SAVING");const e=u.map(((e,t)=>({id:e.id,sortKey:t,name:e.name})));await async function(e){return(0,N.gz)(`${N.NS}/${N.tW}/account`,e)}(e),t({type:"SORT ACCOUNTS",order:e}),o("SAVED"),setTimeout((()=>o("NONE")),1e3)}catch{console.warn("Unable to save order of accounts"),o("NONE")}}),[t,u]);return n.createElement(n.Fragment,null,n.createElement(r.zx,{onClick:()=>c(!0),className:"btn btn-primary flex items-center gap-x-2"},n.createElement(l.j7b,{className:"inline"}),n.createElement("span",{className:"align-middle"},"Order accounts")),n.createElement(r.u_,{isOpen:a,onDismiss:()=>c(!1)},n.createElement("div",{className:"max-h-screen w-80 max-w-full overflow-y-scroll rounded bg-slate-200 p-4 dark:bg-slate-700"},n.createElement("h2",{className:"modal-header"},"Reorder accounts"),n.createElement(S,{className:"m-4 rounded bg-green-500 p-2",typeIdentifier:"ACCOUNT",items:u,setItems:m},d),n.createElement(r.qO,null,n.createElement(r.zx,{buttonType:"Secondary",onClick:()=>c(!1)},"Close"),n.createElement(r.zx,{onClick:i},"Save order"))),"NONE"!==s&&n.createElement("div",{className:"absolute top-0 left-0 z-10 flex h-full w-full flex-row items-center justify-center bg-black opacity-75"},"SAVING"===s&&n.createElement(T,null),"SAVED"===s&&n.createElement("div",{className:"text-xl font-bold"},"Order saved!"))))},R=a(1635);var _=({account:e,entry:t,date:a})=>{const{dispatch:r}=(0,n.useContext)(p),c=(0,n.useRef)(null),s=(0,n.useCallback)((async t=>{const n=(0,d.p3)(t.currentTarget.innerText);NaN!==n&&(await async function(e){await(0,N.v_)(`${N.NS}/${N.tW}/account/entry`,e)}({date:a,amount:n,accountId:e.id}),r({type:"EDIT ENTRY FOR ACCOUNT",name:e.name,key:a,value:n}))}),[e.id,e.name,a,r]),l=(0,d.xG)(t[e.name],e.currency);return n.createElement("td",{key:e.name,contentEditable:!0,ref:c,onBlur:s,className:"px-4 text-right"},l)};var U=()=>{const{state:{accounts:e,entries:t}}=(0,n.useContext)(p),a=function(e,t){return Object.keys(t).map((a=>z(e,t,a)))}(e,t);return n.createElement("div",{className:"h-full overflow-x-auto pb-4"},n.createElement("table",{className:"w-full"},n.createElement(K,{accounts:e}),n.createElement("tbody",null,Object.keys(t).map(((r,c)=>n.createElement("tr",{key:r,className:"whitespace-nowrap text-right font-mono odd:bg-gray-300 dark:odd:bg-gray-800"},n.createElement("td",{className:"pr-6 text-center"},r),n.createElement(j,{date:r,index:c,totals:a}),e.map((e=>n.createElement(_,{key:e.name,account:e,entry:t[r],date:r}))),n.createElement(F,{date:r})))))))};const K=({accounts:e})=>n.createElement("thead",null,n.createElement("tr",{className:"whitespace-nowrap text-right"},n.createElement("th",{className:"pr-6 text-center"},"Date"),n.createElement("th",{className:"px-4 text-green-700 dark:text-green-500"},"Gain"),n.createElement("th",{className:"px-4 text-blue-700 dark:text-blue-500"},"Total"),n.createElement("th",{className:"px-4 text-yellow-700 dark:text-yellow-500"},"Total cash"),n.createElement("th",{className:"px-4 text-purple-700 dark:text-purple-500"},"Total investments"),e.map((e=>n.createElement("th",{key:e.name,className:"px-4"},n.createElement("span",null,e.name)))),n.createElement("th",null))),j=({index:e,date:t,totals:a})=>{const{state:{accounts:r,entries:c}}=(0,n.useContext)(p),s=0===e?0:a[e]-a[e-1],l=a[e],o=z(r,c,t,(e=>"Cash"===e.type)),u=z(r,c,t,(e=>"Investment"===e.type));return n.createElement(n.Fragment,null,n.createElement("td",{className:(0,R.y)(s)},d.oB.format(s)),n.createElement("td",{className:"px-4 text-blue-700 dark:text-blue-500"},d.oB.format(l)),n.createElement("td",{className:"px-4 text-yellow-700 dark:text-yellow-500"},d.oB.format(o)),n.createElement("td",{className:"px-4 text-purple-700 dark:text-purple-500"},d.oB.format(u)))},F=({date:e})=>{const{dispatch:t}=(0,n.useContext)(p);return n.createElement("td",{className:"pl-4"},n.createElement("button",{onClick:()=>t({type:"DELETE ENTRY",date:e}),className:"flex focus:outline-none"},n.createElement(l.BFV,{size:24,className:"text-red-700 dark:text-red-500"})))};function z(e,t,a,r=(()=>!0)){const{values:{currencyRates:s,preferredDisplayCurrency:l}}=(0,n.useContext)(c.Z);return e.filter(r).map((e=>(0,d.fK)(t[a][e.name]??0,s.usd,e.currency,l))).reduce(((e,t)=>e+t),0)}const $=(0,n.memo)((()=>{const[e,t]=(0,n.useReducer)(D,(0,i.v)("account_state",{accounts:[],entries:{}}));(0,n.useEffect)((()=>{(async function(){if(N.xh)return Promise.resolve(x);try{const e=await fetch(`${N.NS}/${N.tW}/account`,{method:"get",credentials:"include"});return(await e.json()).map((e=>({...e,entries:e.entries.map((e=>({...e,date:new Date(Date.parse(e.date))})))})))}catch(e){return console.warn("Failed to get user's accounts"),console.debug(e),[]}})().then((e=>{const a={};for(const t of e)for(const e of t.entries){const n=(0,m.p)(e.date);n in a||(a[n]={}),a[n][t.name]=e.amount}t({type:"LOAD STATE",state:{accounts:e,entries:Object.keys(a).sort().reduce(((e,t)=>(e[t]=a[t],e)),{})}})}))}),[]);const a=(0,n.useCallback)((async e=>{await async function(e){return await(0,N.v_)(`${N.NS}/${N.tW}/account`,e).then((e=>e.json()))}(e),t({type:"ADD ACCOUNT",account:e})}),[t]);return n.createElement(p.Provider,{value:{state:e,dispatch:t}},n.createElement(U,null),n.createElement("div",{className:"flex flex-row justify-between px-4"},n.createElement(u,{addAccount:a}),n.createElement(I,null),n.createElement(w,null)))}));$.displayName="AccountOverview";var P=$,B=a(447);var L=()=>n.createElement(n.Fragment,null,n.createElement(B.Z,{title:"Accounts"}),n.createElement(P,null))},447:function(e,t,a){"use strict";var n=a(9008),r=a.n(n),c=a(7294);t.Z=({title:e})=>c.createElement(r(),null,c.createElement("title",null,e," | Finance"))},1635:function(e,t,a){"use strict";function n(e){return e>0?r.positiveColor:e<0?r.negativeColor:""}a.d(t,{y:function(){return n}});const r={positiveColor:"text-green-700 dark:text-green-500",negativeColor:"text-red-700 dark:text-red-500"}},515:function(e,t,a){"use strict";a.d(t,{CV:function(){return m},fK:function(){return l},oB:function(){return c},p3:function(){return r},sL:function(){return u},xG:function(){return s}});var n=a(7294);function r(e){return Number.parseFloat(e.toString().replace(/[,a-zA-Z]/g,""))}const c=Intl.NumberFormat(void 0,{style:"currency",currency:"DKK",currencyDisplay:"code"});function s(e,t){if(!e||Number.isNaN(e))return"0";const a=t=>e.toLocaleString(void 0,{style:"currency",currency:t,currencyDisplay:"code"});try{return a(t??"USD")}catch(n){return n instanceof RangeError&&n.message.startsWith("Invalid currency code")&&t?a("USD").replace("USD",t):e.toString()}}function l(e,t,a,n){return e*o(t,a,n)}function o(e,t,a){const n="usd";return t=t?.toLowerCase(),a=a?.toLowerCase(),e=e,t&&a&&t!==a?t===n?a in e?e[a]:1:a===n?t in e?1/e[t]:1:o(e,t,n)*o(e,n,a):1}function u(e,t,a){return(0,n.useCallback)((n=>l(n,a,e,t)),[e,a,t])}function m(e){return Object.keys(e).sort().reduce(((t,a)=>(t[a]=e[a],t)),{})}},6645:function(e,t,a){"use strict";function n(e){const t=e.getFullYear();let a=""+(e.getMonth()+1),n=""+e.getDate();return a.length<2&&(a="0"+a),n.length<2&&(n="0"+n),[t,a,n].join("-")}a.d(t,{p:function(){return n}})},8312:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return a(6359)}])}},function(e){e.O(0,[774,536,712,888,179],(function(){return t=8312,e(e.s=t);var t}));var t=e.O();_N_E=t}]);