(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{2381:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return C}});var n=a(7294),r=a(7818),s=a(2283),c=a(2370);function o(){return(o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}var u=({addAccount:e})=>{const[t,a]=(0,n.useState)(!1),{register:u,handleSubmit:l,formState:{errors:m}}=(0,s.cI)(),d=(0,n.useCallback)((()=>a(!1)),[a]);return n.createElement(n.Fragment,null,n.createElement("button",{onClick:()=>a((e=>!e)),className:"btn btn-primary space-x-2"},n.createElement(c.RWZ,{className:"inline"}),n.createElement("span",{className:"align-middle"},"Add account")),n.createElement(r.u_,{isOpen:t,onDismiss:d},n.createElement("form",{onSubmit:l((t=>{e(t),d()}))},n.createElement("div",{className:"p-4"},n.createElement("h2",{className:"text-lg text-gray-700 dark:text-gray-400"},"Add new account"),n.createElement("fieldset",{className:"space-y-2"},n.createElement(r.II,o({placeholder:"Savings, Investments...",label:"Name"},u("name",{required:!0}),{errorMessage:m.name&&"Please provide a name for your account"})),n.createElement("label",{className:"flex flex-col space-y-2"},n.createElement("span",{className:"text-gray-700 dark:text-gray-300 font-medium text-sm"},"Type"),n.createElement("select",o({className:"py-2 px-4 rounded-md shadow focus:outline-none focus:ring focus:border-indigo-400 bg-white dark:bg-gray-900 dark:text-gray-100 undefined"},u("type",{required:!0})),n.createElement("option",{value:"Cash"},"Cash"),n.createElement("option",{value:"Investment"},"Investment"))))),n.createElement(r.qO,null,n.createElement(r.zx,{buttonType:"Transparent",onClick:d},"Cancel"),n.createElement(r.zx,{type:"submit"},"Add")))))},l=a(9184),m=a(8381),d=a(5637);const i=(0,n.createContext)({state:{accounts:[],entries:{}},dispatch:e=>{}});function p(e,t){return(0,d.n)("account_state",D)(e,t)}function D(e,t){switch(t.type){case"RESET":return{accounts:[],entries:{}};case"LOAD STATE":return t.state;case"ADD ACCOUNT":return{...e,accounts:e.accounts.concat(t.account)};case"ADD ENTRY":return e.entries[t.date]={},{...e};case"EDIT ENTRY FOR ACCOUNT":return e.entries[t.key][t.name]=t.value,e.entries=(0,m.CV)(e.entries),{...e};case"DELETE ENTRY":return delete e.entries[t.date],{...e,entries:e.entries};default:return console.warn(`action type not handled: ${JSON.stringify(t)}`),e}}function f(){return(f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}const w=(0,n.memo)((()=>{const{dispatch:e}=(0,n.useContext)(i),[t,a]=(0,n.useState)(!1),c=(0,n.useCallback)((()=>a(!1)),[a]),{register:o,handleSubmit:u}=(0,s.cI)(),l=u((({date:t})=>{e({type:"ADD ENTRY",date:t}),c()}));return n.createElement(n.Fragment,null,n.createElement(r.zx,{buttonType:"Primary",onClick:()=>a(!0)},"Add entry"),n.createElement(r.u_,{isOpen:t,onDismiss:c},n.createElement("form",{onSubmit:l},n.createElement("div",{className:"p-4"},n.createElement("h2",{className:"text-lg text-gray-700 dark:text-gray-400"},"Add new entry on date"),n.createElement(r.II,f({type:"date",className:"m-4"},o("date")))),n.createElement(r.qO,null,n.createElement(r.zx,{buttonType:"Primary",type:"submit"},"Add")))))}));w.displayName="AddEntryModal";var y=w,E=a(5563);var b=[{entries:[{date:new Date(Date.parse("2021-09-01")),amount:81325},{date:new Date(Date.parse("2021-11-01")),amount:89283},{date:new Date(Date.parse("2021-08-01")),amount:86219},{date:new Date(Date.parse("2021-10-01")),amount:59171},{date:new Date(Date.parse("2021-05-01")),amount:29615},{date:new Date(Date.parse("2021-04-01")),amount:49465},{date:new Date(Date.parse("2021-06-01")),amount:49589},{date:new Date(Date.parse("2021-12-01")),amount:89332},{date:new Date(Date.parse("2021-07-01")),amount:44555},{date:new Date(Date.parse("2022-01-01")),amount:89338}],id:"519486d6-41c1-4368-b6ef-678a513f6d77",name:"Cash 1",type:"Cash"},{entries:[{date:new Date(Date.parse("2021-06-01")),amount:40259.18},{date:new Date(Date.parse("2021-11-01")),amount:5218.3},{date:new Date(Date.parse("2021-04-01")),amount:6079.73},{date:new Date(Date.parse("2021-09-01")),amount:5129},{date:new Date(Date.parse("2022-01-01")),amount:5271.17},{date:new Date(Date.parse("2021-05-01")),amount:6254.18},{date:new Date(Date.parse("2021-07-01")),amount:40280.91},{date:new Date(Date.parse("2021-12-01")),amount:5218.3},{date:new Date(Date.parse("2021-08-01")),amount:5129},{date:new Date(Date.parse("2021-10-01")),amount:5218.3}],id:"b1bb265c-1f43-4c55-be89-d45d5980f6c9",name:"Cash 2",type:"Cash"},{entries:[{date:new Date(Date.parse("2021-11-01")),amount:69239.74},{date:new Date(Date.parse("2021-10-01")),amount:84239.74},{date:new Date(Date.parse("2021-08-01")),amount:89239.74},{date:new Date(Date.parse("2021-07-01")),amount:87239.74},{date:new Date(Date.parse("2021-12-01")),amount:57266.74},{date:new Date(Date.parse("2021-06-01")),amount:72239.74},{date:new Date(Date.parse("2021-04-01")),amount:42240.63},{date:new Date(Date.parse("2021-05-01")),amount:82239.74},{date:new Date(Date.parse("2021-09-01")),amount:94239.74},{date:new Date(Date.parse("2022-01-01")),amount:52268.55}],id:"409d4daf-1e82-41e6-868f-10f7b07e4eea",name:"Cash 3",type:"Cash"},{entries:[{date:new Date(Date.parse("2021-09-01")),amount:317366},{date:new Date(Date.parse("2022-01-01")),amount:407768},{date:new Date(Date.parse("2021-04-01")),amount:208656},{date:new Date(Date.parse("2021-06-01")),amount:230487},{date:new Date(Date.parse("2021-11-01")),amount:393617},{date:new Date(Date.parse("2021-08-01")),amount:328161},{date:new Date(Date.parse("2021-10-01")),amount:346711},{date:new Date(Date.parse("2021-05-01")),amount:230433},{date:new Date(Date.parse("2021-12-01")),amount:427277},{date:new Date(Date.parse("2021-07-01")),amount:254852}],id:"35814c7b-c6c0-4d42-9999-c6a3bb5fabe5",name:"Invest 1",type:"Investment"},{entries:[{date:new Date(Date.parse("2021-12-01")),amount:82},{date:new Date(Date.parse("2021-05-01")),amount:240072},{date:new Date(Date.parse("2022-01-01")),amount:10071},{date:new Date(Date.parse("2021-07-01")),amount:200072},{date:new Date(Date.parse("2021-10-01")),amount:50072},{date:new Date(Date.parse("2021-08-01")),amount:90072},{date:new Date(Date.parse("2021-04-01")),amount:260072},{date:new Date(Date.parse("2021-11-01")),amount:30072},{date:new Date(Date.parse("2021-06-01")),amount:220072},{date:new Date(Date.parse("2021-09-01")),amount:70072}],id:"89cc16a3-1940-4fb3-bb78-759ede40006a",name:"Invest 2",type:"Investment"},{entries:[{date:new Date(Date.parse("2021-11-01")),amount:6796.32},{date:new Date(Date.parse("2021-05-01")),amount:4902.71},{date:new Date(Date.parse("2021-08-01")),amount:4354.32},{date:new Date(Date.parse("2021-09-01")),amount:6578.02},{date:new Date(Date.parse("2021-12-01")),amount:7363.61},{date:new Date(Date.parse("2021-07-01")),amount:3959.97},{date:new Date(Date.parse("2021-10-01")),amount:5821.36},{date:new Date(Date.parse("2022-01-01")),amount:6041.41},{date:new Date(Date.parse("2021-04-01")),amount:82},{date:new Date(Date.parse("2021-06-01")),amount:4630.42}],id:"d05d7e7c-120c-4d15-8f79-14bcbf24c353",name:"Invest 3",type:"Investment"}];var N=({account:e,entry:t,date:a})=>{const{dispatch:r}=(0,n.useContext)(i),s=(0,n.useRef)(null),c=(0,n.useCallback)((async t=>{const n=(0,m.p3)(t.currentTarget.innerText);NaN!==n&&(await async function(e){await(0,E.v_)(`${E.NS}/${E.tW}/account/entry`,e)}({date:a,amount:n,accountId:e.id}),r({type:"EDIT ENTRY FOR ACCOUNT",name:e.name,key:a,value:n}))}),[e.id,e.name,a,r]),o=m.oB.format(t[e.name]??0);return n.createElement("td",{key:e.name,contentEditable:!0,ref:s,onBlur:c,className:"px-4 text-right"},o)};var x=({accounts:e,entries:t})=>{const{dispatch:a}=(0,n.useContext)(i),r=Object.keys(t).map((a=>h(e,t,a)));return n.createElement("div",{className:"h-full overflow-x-auto pb-4"},n.createElement("table",{className:"w-full"},n.createElement("thead",null,n.createElement("tr",{className:"text-right whitespace-nowrap"},n.createElement("th",{className:"text-center pr-6"},"Date"),n.createElement("th",{className:"text-green-700 dark:text-green-500 px-4"},"Gain"),n.createElement("th",{className:"text-blue-700 dark:text-blue-500 px-4"},"Total"),n.createElement("th",{className:"text-yellow-700 dark:text-yellow-500 px-4"},"Total cash"),n.createElement("th",{className:"text-purple-700 dark:text-purple-500 px-4"},"Total investments"),e.map((e=>n.createElement("th",{key:e.name,className:"px-4"},n.createElement("span",null,e.name)))),n.createElement("th",null))),n.createElement("tbody",null,Object.keys(t).map(((s,o)=>{const u=0===o?0:r[o]-r[o-1],l=r[o],d=h(e,t,s,(e=>"Cash"===e.type)),i=h(e,t,s,(e=>"Investment"===e.type));return n.createElement("tr",{key:s,className:"odd:bg-gray-300 dark:odd:bg-gray-800 text-right whitespace-nowrap font-mono"},n.createElement("td",{className:"text-center pr-6"},s),n.createElement("td",{className:"text-green-700 dark:text-green-500"},m.oB.format(u)),n.createElement("td",{className:"text-blue-700 dark:text-blue-500 px-4"},m.oB.format(l)),n.createElement("td",{className:"text-yellow-700 dark:text-yellow-500 px-4"},m.oB.format(d)),n.createElement("td",{className:"text-purple-700 dark:text-purple-500 px-4"},m.oB.format(i)),e.map((e=>n.createElement(N,{key:e.name,account:e,entry:t[s],date:s}))),n.createElement("td",{className:"pl-4"},n.createElement("button",{onClick:()=>a({type:"DELETE ENTRY",date:s}),className:"flex focus:outline-none"},n.createElement(c.BFV,{size:24,className:"text-red-700 dark:text-red-500"}))))})))))};function h(e,t,a,n=(()=>!0)){return e.filter(n).map((e=>t[a][e.name]??0)).reduce(((e,t)=>e+t),0)}const g=(0,n.memo)((()=>{const[e,t]=(0,n.useReducer)(p,(0,d.v)("account_state",{accounts:[],entries:{}}));(0,n.useEffect)((()=>{(async function(){if(E.xh)return Promise.resolve(b);try{const e=await fetch(`${E.NS}/${E.tW}/account`,{method:"get",credentials:"include"});return(await e.json()).map((e=>({...e,entries:e.entries.map((e=>({...e,date:new Date(Date.parse(e.date))})))})))}catch(e){return console.debug(e),[]}})().then((e=>{const a={};for(const t of e)for(const e of t.entries){const n=(0,l.p)(e.date);n in a||(a[n]={}),a[n][t.name]=e.amount}t({type:"LOAD STATE",state:{accounts:e,entries:Object.keys(a).sort().reduce(((e,t)=>(e[t]=a[t],e)),{})}})}))}),[]);const a=(0,n.useCallback)((async e=>{await async function(e){return await(0,E.v_)(`${E.NS}/${E.tW}/account`,e).then((e=>e.json()))}(e),t({type:"ADD ACCOUNT",account:e})}),[t]);return n.createElement(i.Provider,{value:{state:e,dispatch:t}},n.createElement(x,{accounts:e.accounts,entries:e.entries}),n.createElement("div",{className:"px-4 flex flex-row justify-between"},n.createElement(u,{addAccount:a}),n.createElement(y,null)))}));g.displayName="AccountOverview";var v=g,k=a(7515);var C=()=>n.createElement(n.Fragment,null,n.createElement(k.Z,{title:"Accounts"}),n.createElement(v,null))},7515:function(e,t,a){"use strict";var n=a(9008),r=a(7294);t.Z=({title:e})=>r.createElement(n.default,null,r.createElement("title",null,e," | Finance"))},8381:function(e,t,a){"use strict";a.d(t,{p3:function(){return r},oB:function(){return s},xG:function(){return c},fK:function(){return o},sL:function(){return l},CV:function(){return d}});var n=a(7294);function r(e){return Number.parseFloat(e.toString().replace(/[,a-zA-Z]/g,""))}const s=Intl.NumberFormat(void 0,{style:"currency",currency:"DKK",currencyDisplay:"code"});function c(e,t){return Number.isNaN(e)?"-":e.toLocaleString(void 0,{style:"currency",currency:t??"USD",currencyDisplay:"code"})}function o(e,t,a,n){return e*u(t,a,n)}function u(e,t,a){const n="usd";return e=e?.toLowerCase(),t=t?.toLowerCase(),a=a??m,e&&t&&e!==t?e===n?t in a?a[t]:1:t===n?e in a?1/a[e]:1:u(e,n)*u(n,t):1}function l(e,t,a){return(0,n.useCallback)((n=>o(n,e,t,a)),[e,a,t])}const m={dkk:6.36,nok:9,eur:.85};function d(e){return Object.keys(e).sort().reduce(((t,a)=>(t[a]=e[a],t)),{})}},9184:function(e,t,a){"use strict";function n(e){const t=e.getFullYear();let a=""+(e.getMonth()+1),n=""+e.getDate();return a.length<2&&(a="0"+a),n.length<2&&(n="0"+n),[t,a,n].join("-")}a.d(t,{p:function(){return n}})},5637:function(e,t,a){"use strict";function n(e,t={}){const a=localStorage.getItem(e)??void 0;return{...t,...void 0===a||""===a?{}:JSON.parse(a)}}function r(e,t){return(a,n)=>{const r=t(a,n);return localStorage.setItem(e,JSON.stringify(r)),r}}a.d(t,{v:function(){return n},n:function(){return r}})},5301:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return a(2381)}])}},function(e){e.O(0,[283,888,774,179],(function(){return t=5301,e(e.s=t);var t}));var t=e.O();_N_E=t}]);