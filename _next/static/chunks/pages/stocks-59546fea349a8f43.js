(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[170],{1365:function(e,t,a){"use strict";let r;a.r(t),a.d(t,{default:function(){return Z}});var n=a(7294),l=a(6508),s=a(2370),o=a(515),c=a(7818),i=a(7536),u=a(7538);let d=[{symbol:"AAPL",lots:[{id:"a180c2da-7db5-4326-9d8d-29259bf0d004",shares:6,buyDate:new Date(new Date("2021-04-19T00:00:00+00:00")),buyPrice:124,buyBrokerage:0,soldDate:void 0,soldPrice:void 0,soldBrokerage:void 0},{id:"41705304-bf6d-46cd-bb69-5c60745dd222",shares:3,buyDate:new Date(new Date("2020-02-06T00:00:00+00:00")),buyPrice:86,buyBrokerage:0,soldDate:void 0,soldPrice:void 0,soldBrokerage:void 0}],language:"en-US",region:"US",quoteType:"EQUITY",quoteSourceName:"Delayed Quote",triggerable:!0,currency:"USD",marketState:"CLOSED",shortName:"Apple Inc.",firstTradeDateMilliseconds:3454794e5,fiftyTwoWeekLowChangePercent:.5280097,priceHint:2,postMarketChangePercent:.08447029,postMarketTime:1640998796,postMarketPrice:177.72,postMarketChange:.1499939,regularMarketChange:-.6299896,regularMarketChangePercent:-.35352954,regularMarketTime:1640984403,regularMarketPrice:177.57,regularMarketDayHigh:179.23,regularMarketDayRange:"177.26 - 179.23",regularMarketDayLow:177.26,regularMarketVolume:64062281,regularMarketPreviousClose:178.2,bid:177.71,ask:177.6,bidSize:8,askSize:12,fullExchangeName:"NasdaqGS",financialCurrency:"USD",regularMarketOpen:178.085,averageDailyVolume3Month:88974236,averageDailyVolume10Day:89469180,fiftyTwoWeekLowChange:61.36001,epsTrailingTwelveMonths:5.61,epsForward:6.18,epsCurrentYear:5.74,priceEpsCurrentYear:30.935543,sharesOutstanding:164064e5,bookValue:3.841,fiftyDayAverage:162.0976,fiftyDayAverageChange:15.472412,fiftyDayAverageChangePercent:.09545121,twoHundredDayAverage:143.95364,twoHundredDayAverageChange:33.616364,twoHundredDayAverageChangePercent:.23352215,marketCap:2913284653056,forwardPE:28.733011,priceToBook:46.23015,sourceInterval:15,exchangeDataDelayedBy:0,exchange:"NMS",longName:"Apple Inc.",messageBoardId:"finmb_24937",exchangeTimezoneName:"America/New_York",exchangeTimezoneShortName:"EST",gmtOffSetMilliseconds:-18e6,market:"us_market",esgPopulated:!1,fiftyTwoWeekRange:"116.21 - 182.13",fiftyTwoWeekHighChange:-4.5599976,fiftyTwoWeekHighChangePercent:-.025037047,fiftyTwoWeekLow:116.21,fiftyTwoWeekHigh:182.13,dividendDate:1636588800,earningsTimestamp:1635438600,earningsTimestampStart:1643144400,earningsTimestampEnd:1643662800,trailingAnnualDividendRate:.85,trailingPE:31.652407,trailingAnnualDividendYield:.004769922,averageAnalystRating:"1.8 - Buy",tradeable:!1,displayName:"Apple"},{symbol:"GOOGL",lots:[{id:"24f14409-5869-4ff9-be8a-98a6ef673060",shares:2,buyDate:new Date(new Date("2020-04-09T00:00:00+00:00")),buyPrice:1213,buyBrokerage:0,soldDate:void 0,soldPrice:void 0,soldBrokerage:void 0}],language:"en-US",region:"US",quoteType:"EQUITY",quoteSourceName:"Delayed Quote",triggerable:!0,currency:"USD",marketState:"CLOSED",shortName:"Alphabet Inc.",firstTradeDateMilliseconds:10929222e5,fiftyTwoWeekLowChangePercent:.7080597,priceHint:2,postMarketChangePercent:.102171905,postMarketTime:1640998793,postMarketPrice:2900,postMarketChange:2.959961,regularMarketChange:-26.96997,regularMarketChangePercent:-.9223625,regularMarketTime:1640984403,regularMarketPrice:2897.04,regularMarketDayHigh:2933.97,regularMarketDayRange:"2897.04 - 2933.97",regularMarketDayLow:2897.04,regularMarketVolume:906759,regularMarketPreviousClose:2924.01,bid:2898,ask:2901.52,bidSize:9,askSize:10,fullExchangeName:"NasdaqGS",financialCurrency:"USD",regularMarketOpen:2921,averageDailyVolume3Month:1518517,averageDailyVolume10Day:1224160,fiftyTwoWeekLowChange:1200.9401,epsTrailingTwelveMonths:103.805,epsForward:112.42,epsCurrentYear:108.39,priceEpsCurrentYear:26.727928,sharesOutstanding:300809984,bookValue:367.946,fiftyDayAverage:2908.6145,fiftyDayAverageChange:-11.574463,fiftyDayAverageChangePercent:-.0039793733,twoHundredDayAverage:2620.165,twoHundredDayAverageChange:276.875,twoHundredDayAverageChangePercent:.105670825,marketCap:1921705181184,forwardPE:25.769793,priceToBook:7.8735466,sourceInterval:15,exchangeDataDelayedBy:0,exchange:"NMS",longName:"Alphabet Inc.",messageBoardId:"finmb_29096",exchangeTimezoneName:"America/New_York",exchangeTimezoneShortName:"EST",gmtOffSetMilliseconds:-18e6,market:"us_market",esgPopulated:!1,fiftyTwoWeekRange:"1696.1 - 3019.33",fiftyTwoWeekHighChange:-122.29004,fiftyTwoWeekHighChangePercent:-.040502377,fiftyTwoWeekLow:1696.1,fiftyTwoWeekHigh:3019.33,dividendDate:0,earningsTimestamp:1635278400,earningsTimestampStart:1643662800,earningsTimestampEnd:1644008400,trailingAnnualDividendRate:0,trailingPE:27.908482,trailingAnnualDividendYield:0,averageAnalystRating:"1.7 - Buy",tradeable:!1,displayName:""},{symbol:"MSFT",lots:[{id:"4c7c2e1e-78f9-407c-9747-b3d3f860087f",shares:10,buyDate:new Date("2020-01-06T00:00:00+00:00"),buyPrice:148,buyBrokerage:0,soldDate:void 0,soldPrice:void 0,soldBrokerage:void 0},{id:"dfeb996b-ba02-4533-b4ef-67a8ac5a0173",shares:13,buyDate:new Date("2021-07-02T00:00:00+00:00"),buyPrice:257,buyBrokerage:0,soldDate:void 0,soldPrice:void 0,soldBrokerage:void 0}],language:"en-US",region:"US",quoteType:"EQUITY",quoteSourceName:"Nasdaq Real Time Price",triggerable:!0,currency:"USD",marketState:"CLOSED",shortName:"Microsoft Corporation",firstTradeDateMilliseconds:5111082e5,fiftyTwoWeekLowChangePercent:.58686423,priceHint:2,postMarketChangePercent:.139748,postMarketTime:1640998788,postMarketPrice:336.79,postMarketChange:.470001,regularMarketChange:-3,regularMarketChangePercent:-.8841212,regularMarketTime:1640984404,regularMarketPrice:336.32,regularMarketDayHigh:339.35,regularMarketDayRange:"335.85 - 339.35",regularMarketDayLow:335.85,regularMarketVolume:17943888,regularMarketPreviousClose:339.32,bid:336.32,ask:336.79,bidSize:13,askSize:9,fullExchangeName:"NasdaqGS",financialCurrency:"USD",regularMarketOpen:338.51,averageDailyVolume3Month:25744050,averageDailyVolume10Day:22989170,fiftyTwoWeekLowChange:124.380005,epsTrailingTwelveMonths:8.939,epsForward:10.53,epsCurrentYear:9.21,priceEpsCurrentYear:36.51683,sharesOutstanding:7507979776,bookValue:20.242,fiftyDayAverage:331.8472,fiftyDayAverageChange:4.472809,fiftyDayAverageChangePercent:.013478519,twoHundredDayAverage:287.4741,twoHundredDayAverageChange:48.845917,twoHundredDayAverageChangePercent:.16991416,marketCap:2525083729920,forwardPE:31.939222,priceToBook:16.61496,sourceInterval:15,exchangeDataDelayedBy:0,exchange:"NMS",longName:"Microsoft Corporation",messageBoardId:"finmb_21835",exchangeTimezoneName:"America/New_York",exchangeTimezoneShortName:"EST",gmtOffSetMilliseconds:-18e6,market:"us_market",esgPopulated:!1,fiftyTwoWeekRange:"211.94 - 349.67",fiftyTwoWeekHighChange:-13.350006,fiftyTwoWeekHighChangePercent:-.03817887,fiftyTwoWeekLow:211.94,fiftyTwoWeekHigh:349.67,dividendDate:1646870400,earningsTimestamp:1635264756,earningsTimestampStart:1643021940,earningsTimestampEnd:1643371200,trailingAnnualDividendRate:2.3,trailingPE:37.623894,trailingAnnualDividendYield:.006778262,averageAnalystRating:"1.7 - Buy",tradeable:!1,displayName:"Microsoft"},{symbol:"VWS.CO",lots:[{id:"5672c6b2-ff51-4afc-bb9e-8250a20563a6",shares:100,buyDate:new Date("2020-04-09T00:00:00+00:00"),buyPrice:130,buyBrokerage:0,soldDate:void 0,soldPrice:void 0,soldBrokerage:void 0}],language:"en-US",region:"US",quoteType:"EQUITY",quoteSourceName:"Delayed Quote",triggerable:!0,currency:"DKK",marketState:"CLOSED",shortName:"Vestas Wind Systems A/S",firstTradeDateMilliseconds:957942e6,fiftyTwoWeekLowChangePercent:.17577891,priceHint:2,postMarketChangePercent:0,postMarketTime:0,postMarketPrice:0,postMarketChange:0,regularMarketChange:4.5,regularMarketChangePercent:2.3017902,regularMarketTime:1640879978,regularMarketPrice:200,regularMarketDayHigh:200.4,regularMarketDayRange:"195.25 - 200.4",regularMarketDayLow:195.25,regularMarketVolume:1908374,regularMarketPreviousClose:195.5,bid:200.1,ask:0,bidSize:0,askSize:0,fullExchangeName:"Copenhagen",financialCurrency:"EUR",regularMarketOpen:195.5,averageDailyVolume3Month:2966962,averageDailyVolume10Day:2299444,fiftyTwoWeekLowChange:29.899994,epsTrailingTwelveMonths:5.24,epsForward:.6,epsCurrentYear:.42,priceEpsCurrentYear:476.1905,sharesOutstanding:1009059968,bookValue:4.689,fiftyDayAverage:223.41,fiftyDayAverageChange:-23.410004,fiftyDayAverageChangePercent:-.104784936,twoHundredDayAverage:238.20094,twoHundredDayAverageChange:-38.200943,twoHundredDayAverageChangePercent:-.16037276,marketCap:201812000768,forwardPE:333.3333,priceToBook:42.653015,sourceInterval:15,exchangeDataDelayedBy:0,exchange:"CPH",longName:"Vestas Wind Systems A/S",messageBoardId:"finmb_36246",exchangeTimezoneName:"Europe/Copenhagen",exchangeTimezoneShortName:"CET",gmtOffSetMilliseconds:36e5,market:"dk_market",esgPopulated:!1,fiftyTwoWeekRange:"170.1 - 321.0",fiftyTwoWeekHighChange:-121,fiftyTwoWeekHighChangePercent:-.37694705,fiftyTwoWeekLow:170.1,fiftyTwoWeekHigh:321,dividendDate:0,earningsTimestamp:1643799540,earningsTimestampStart:1643799540,earningsTimestampEnd:1643799540,trailingAnnualDividendRate:.228,trailingPE:38.167942,trailingAnnualDividendYield:.0011662404,averageAnalystRating:"4.0 - Underperform",tradeable:!1,displayName:""}];function m(){let e=(0,u.t1)();return(0,n.useCallback)((...t)=>u.xh?Promise.resolve(d):e(`${u.ft}/stock?symbols=${t.join(",")}`,{method:"GET"}).then(async e=>e?await e.json():[]),[e])}var g=a(7384);let y="undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);var f={randomUUID:y};let k=new Uint8Array(16);function p(){if(!r&&!(r="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)))throw Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return r(k)}let b=[];for(let h=0;h<256;++h)b.push((h+256).toString(16).slice(1));var E=function(e,t,a){if(f.randomUUID&&!t&&!e)return f.randomUUID();e=e||{};let r=e.random||(e.rng||p)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){a=a||0;for(let n=0;n<16;++n)t[a+n]=r[n];return t}return function(e,t=0){return(b[e[t+0]]+b[e[t+1]]+b[e[t+2]]+b[e[t+3]]+"-"+b[e[t+4]]+b[e[t+5]]+"-"+b[e[t+6]]+b[e[t+7]]+"-"+b[e[t+8]]+b[e[t+9]]+"-"+b[e[t+10]]+b[e[t+11]]+b[e[t+12]]+b[e[t+13]]+b[e[t+14]]+b[e[t+15]]).toLowerCase()}(r)};let D="stocks_state",C=(0,n.createContext)({state:T(),dispatch(e){}});function v(e,t){return(0,g.n)(D,w)(e,t)}function T(){let e=(0,g.v)(D,{stocks:[],preferredCurrency:"usd",currencyRates:{usd:{}}});for(let t of Object.keys(e.stocks))for(let a of e.stocks[t].lots)a.buyDate=new Date(Date.parse(a.buyDate)),a.soldDate=a.soldDate?new Date(Date.parse(a.soldDate)):void 0;return e}function w(e,t){switch(t.type){case"ADD STOCK":if(e.stocks.find(e=>e.symbol===t.stock.symbol))return e;return{...e,stocks:e.stocks.concat(t.stock)};case"DELETE STOCK":return{...e,stocks:e.stocks.filter(e=>e.symbol!==t.symbol)};case"UPDATE STOCKS":return console.log(t.stocks),{...e,stocks:e.stocks.map(e=>{let a=t.stocks.find(t=>t.symbol===e.symbol);return{...e,...a,lots:e.lots}})};case"SET STOCKS":return{...e,stocks:t.stocks.map(e=>({...e,lots:e.lots??[]}))};case"ADD LOT":{let a={id:t.lotId??E(),shares:0,buyDate:new Date,buyPrice:e.stocks.find(e=>e.symbol===t.symbol)?.regularMarketPrice??0,buyBrokerage:0};return{...e,stocks:e.stocks.map(e=>e.symbol!==t.symbol?e:{...e,lots:e.lots.concat(a)})}}case"DELETE LOT":return{...e,stocks:e.stocks.map(e=>e.symbol!==t.symbol?e:{...e,lots:e.lots.filter(e=>e.id!==t.id)})};case"EDIT LOT":return{...e,stocks:e.stocks.map(e=>e.symbol!==t.symbol?e:{...e,lots:e.lots.filter(e=>e.id!==t.lot.id).concat(t.lot)})};default:return console.warn("action not implemented"),e}}function S(){return(S=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}let N=()=>{let{dispatch:e}=(0,n.useContext)(C),t=m(),a=(0,u.ku)(`${u.ft}/stock/tracked`,{method:"POST"}),[r,l]=(0,n.useState)(!1),{register:o,handleSubmit:d,formState:{errors:g},reset:y}=(0,i.cI)(),f=(0,n.useCallback)(async r=>{let n=await t(r.symbol);0===n.length?alert(`Stock with symbol '${r.symbol}' was not found`):(await a(r.symbol),e({type:"ADD STOCK",stock:{...n[0],symbol:r.symbol,lots:[]}}),y())},[e,t,y,a]);return n.createElement(n.Fragment,null,n.createElement("button",{className:"btn btn-primary space-x-2",onClick:()=>l(!0)},n.createElement(s.RWZ,{className:"inline"}),n.createElement("span",{className:"align-middle"},"Add symbol")),n.createElement(c.u_,{isOpen:r,onDismiss:()=>l(!1)},n.createElement("div",{className:"rounded bg-gray-300 p-4 dark:bg-gray-700"},n.createElement("h3",{className:"pb-4 text-lg font-bold"},"Add symbol"),n.createElement("form",{onSubmit:d(f),className:"space-y-4"},n.createElement("fieldset",{className:"space-y-2"},n.createElement(c.II,S({placeholder:"AAPL, MSFT...",label:"Symbol"},o("symbol",{required:!0}),{errorMessage:g.symbol&&"Please provide a symbol to add"}))),n.createElement(c.qO,null,n.createElement(c.zx,{type:"submit",className:"btn btn-primary order-last ml-4"},"Add"),n.createElement(c.zx,{buttonType:"Transparent",onClick:()=>l(!1)},"Cancel"))))))};var M=a(2308);function P(e){return(0,M.S)(...e.lots.map(e=>e.shares))}function x(e){let t=P(e);return(0,M.S)(...e.lots.map(e=>e.shares*e.buyPrice))/t}function A(e,t,a){let r=P(e),n=x(e);return(0,o.fK)(r*e.regularMarketPrice-r*n,t?.usd,e.currency,a)}let O=()=>{let{state:e,dispatch:t}=(0,n.useContext)(C),a=m(),r=(0,n.useCallback)(async()=>{try{let r=await a(...e.stocks.map(e=>e.symbol));t({type:"UPDATE STOCKS",stocks:r})}catch(n){console.error(n)}},[a,e.stocks,t]);return n.createElement(c.zx,{onClick:r,className:"btn btn-primary space-x-2"},n.createElement(s.A$d,{"aria-label":"Reload current stock prices",className:"inline"}),n.createElement("span",{className:"align-middle"},"Refresh stocks"))};var L=a(1635),B=a(6645);function U(){return(U=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}let K=({stock:e,lot:t})=>{let{dispatch:a}=(0,n.useContext)(C),r=function(){let e=(0,u.t1)();return(0,n.useCallback)((t,a)=>e(`${u.ft}/stock/lot/${t}`,{method:"PUT"},a),[e])}(),c=function(){let e=(0,u.t1)();return(0,n.useCallback)(t=>e(`${u.ft}/stock/lot/${t}`,{method:"DELETE"}),[e])}(),{values:{currencyRates:d,preferredDisplayCurrency:m}}=(0,n.useContext)(l.Z),{register:g,handleSubmit:y,watch:f}=(0,i.cI)({mode:"onChange",defaultValues:{...t,buyDate:(0,B.p)(t.buyDate)}}),k=(0,n.useCallback)(async t=>{if(""===t.buyDate)return;let n={shares:Number(t.shares),buyPrice:Number(t.buyPrice),buyDate:new Date(Date.parse(t.buyDate.toString())),buyBrokerage:0};await r(t.id,n),a({type:"EDIT LOT",symbol:e.symbol,lot:{...n,id:t.id}})},[a,e.symbol,r]),p=(0,n.useCallback)(async()=>{await c(t.id),a({type:"DELETE LOT",symbol:e.symbol,id:t.id})},[c,a,t.id,e.symbol]),b=(0,o.sL)(e.currency,m,d.usd),h=f("shares")*e.regularMarketPrice,E=f("buyPrice")*f("shares"),D=h-E;return n.createElement("tr",{className:"odd:bg-gray-200 dark:odd:bg-gray-600"},n.createElement("td",{colSpan:3},n.createElement("form",{onChange:y(k),className:"flex w-full flex-row justify-evenly"},n.createElement("input",U({type:"date"},g("buyDate"),{className:"bg-transparent"})),n.createElement("input",U({type:"number"},g("shares"),{className:"w-20 bg-transparent text-center"})),n.createElement("input",U({type:"number"},g("buyPrice"),{className:"w-20 bg-transparent text-center"})))),n.createElement("td",{className:"text-right"},(0,o.xG)(b(h),m)),n.createElement("td",{className:`${(0,L.y)(D)} flex flex-col text-right`},n.createElement("span",null,(0,o.xG)(b(D),m)),n.createElement("span",null,((h/E-1)*100).toFixed(2)," %")),n.createElement("td",{className:"pl-4"},n.createElement("button",{onClick:p},n.createElement(s.BFV,{className:"text-red-700 dark:text-red-500",size:24}))))},W=({lots:e,stock:t})=>{let{dispatch:a}=(0,n.useContext)(C),r=function(){let e=(0,u.ku)(`${u.ft}/stock/lot`,{method:"POST"});return(0,n.useCallback)(async t=>{let a=await e(t);return await a?.json()},[e])}(),l=(0,n.useCallback)(async()=>{let e=await r({symbol:t.symbol,shares:0,buyDate:new Date,buyPrice:0,buyBrokerage:0});a({type:"ADD LOT",symbol:t.symbol,lotId:e})},[r,a,t.symbol]);return n.createElement(n.Fragment,null,n.createElement("h3",{className:"text-center text-2xl text-green-700 dark:text-green-400"},"Lots for ",t.displayName??t.symbol),n.createElement("div",{className:"mx-8 rounded bg-gray-300 shadow dark:bg-gray-700"},n.createElement("table",{className:"w-full"},n.createElement("thead",null,n.createElement("tr",null,n.createElement("th",null,"Buy date"),n.createElement("th",null,"Shares"),n.createElement("th",null,"Buy price"),n.createElement("th",null,"Market value"),n.createElement("th",null,"Total gain"))),n.createElement("tbody",null,e.map(e=>n.createElement(K,{key:e.id,lot:e,stock:t})))),n.createElement("div",{className:"p-4"},n.createElement(c.zx,{onClick:l,className:"btn btn-primary space-x-2"},n.createElement(s.RWZ,{className:"inline"}),n.createElement("span",{className:"align-middle"},"Add lot")))))},H=({stock:e})=>{let{values:{preferredDisplayCurrency:t,currencyRates:a}}=(0,n.useContext)(l.Z),r=(0,o.sL)(e.currency,t,a.usd),s=P(e),c=x(e),i=e.regularMarketPrice*s,u=A(e,a,t),d=(i/(c*s)-1)*100,[m,g]=(0,n.useState)(!1);return n.createElement(n.Fragment,null,n.createElement("tr",{className:"relative w-full bg-gray-200 text-right dark:bg-gray-800"},n.createElement("td",{className:"px-2 text-left"},e.symbol),n.createElement("td",{className:"px-2"},(0,o.xG)(e.regularMarketPrice,e.currency)),n.createElement("td",{className:"px-0"},(0,o.xG)(r(i),t)),n.createElement("td",null,s),n.createElement("td",{className:`px-2 ${(0,L.y)(c)}`},(0,o.xG)(c,e.currency)),n.createElement("td",{className:`px-2 ${(0,L.y)(u)}`},n.createElement("span",null,(0,o.xG)(u,t))),n.createElement("td",{className:`px-1 ${(0,L.y)(d)}`},n.createElement("span",{className:isNaN(d)?"hidden":""},d.toFixed(2)," %")),n.createElement(G,{stock:e,setShowLots:g})),n.createElement("tr",null,n.createElement("td",{colSpan:7,className:`p-0 pb-4 ${m?"":"hidden"}`},n.createElement(W,{lots:e.lots,stock:e}))))},G=({stock:e,setShowLots:t})=>{let{dispatch:a}=(0,n.useContext)(C),r=(0,n.useCallback)(()=>{a({type:"DELETE STOCK",symbol:e.symbol})},[a,e.symbol]);return n.createElement("td",{className:"flex h-full flex-row justify-end space-x-2 px-4"},n.createElement("button",{onClick:()=>t(e=>!e),className:"hover:cursor-pointer"},n.createElement(s.XSk,{size:24})),n.createElement("button",{onClick:r,className:"hover:cursor-pointer"},n.createElement(s.BFV,{className:"text-red-500",size:24})))},I=({stocks:e})=>{let{values:{preferredDisplayCurrency:t,currencyRates:a}}=(0,n.useContext)(l.Z),r=(0,n.useMemo)(()=>(0,M.S)(...e.flatMap(e=>e.lots.map(r=>(0,o.fK)(e.regularMarketPrice*r.shares,a.usd,e.currency,t)))),[a.usd,t,e]),s=(0,n.useMemo)(()=>(0,M.S)(...e.flatMap(e=>e.lots.map(r=>(0,o.fK)(e.regularMarketPrice*r.shares-r.buyPrice*r.shares,a.usd,e.currency,t)))),[a.usd,t,e]);return n.createElement("tr",{className:"text-right font-bold dark:text-purple-400"},n.createElement("td",null),n.createElement("td",null),n.createElement("td",null,(0,o.xG)(r,t)),n.createElement("td",null),n.createElement("td",null),n.createElement("td",null,(0,o.xG)(s,t)),n.createElement("td",null,((r/(r-s)-1)*100).toFixed(2)," %"))},R=()=>{let[e,t]=(0,n.useReducer)(v,T()),a=(0,u.h_)(`${u.ft}/stock/tracked`,{method:"GET"},function(e){return e.map(e=>({...e,lots:e.lots.map(e=>({...e,buyDate:new Date(Date.parse(e.buyDate)),soldDate:e.soldDate?new Date(Date.parse(e.soldDate)):void 0}))}))}),r=m();return(0,n.useEffect)(()=>{!a.loading&&a.data&&(t({type:"SET STOCKS",stocks:a.data}),(async()=>{if(a.data){let e=await r(...a.data.map(e=>e.symbol));t({type:"UPDATE STOCKS",stocks:e})}})())},[a.data]),n.createElement(C.Provider,{value:{state:e,dispatch:t}},n.createElement("h2",{className:"page-header"},"Stocks"),n.createElement(z,{stocks:e.stocks}),n.createElement(V,null))},z=({stocks:e})=>{let{values:{currencyRates:t,preferredDisplayCurrency:a}}=(0,n.useContext)(l.Z),[r,s]=(0,n.useState)(),[c,i]=(0,n.useState)(!1);return n.createElement("div",{className:"overflow-x-scroll"},n.createElement("table",{className:"w-full"},n.createElement("thead",null,n.createElement(_,{sortKey:r,ascending:c,setAscending:i,setSortKey:s})),n.createElement("tbody",null,e.sort(function(e,t,a,r){if(!t)return()=>0;let n=t=>(0,o.fK)(t.regularMarketPrice,e?.usd,t.currency,r);return(l,s)=>{let c=0;switch(t){case"Symbol":c=l.symbol.localeCompare(s.symbol);break;case"Gain":c=A(l,e,r)-A(s,e,r);break;case"Gain percentage":let i=e=>{let t=P(e),a=x(e)*t;return(e.regularMarketPrice*t/a-1)*100};c=i(l)-i(s);break;case"Average price":c=(0,o.fK)(x(l),e.usd,l.currency,r)-(0,o.fK)(x(s),e.usd,s.currency,r);break;case"Current price":c=n(l)-n(s);break;case"Total shares":c=P(l)-P(s);break;case"Total value":c=n(l)*P(l)-n(s)*P(s)}return c*(a?1:-1)}}(t,r,c,a)).map(e=>n.createElement(H,{key:e.symbol,stock:e}))),n.createElement("tfoot",null,n.createElement(I,{stocks:e}))))},_=({sortKey:e,ascending:t,setAscending:a,setSortKey:r})=>{let l=(0,n.useCallback)(t=>()=>{e===t?a(e=>!e):r(t)},[r,a,e]);return n.createElement("tr",{className:"align-bottom text-sm text-gray-600 dark:text-gray-400"},n.createElement($,{sort:l,currentSortKey:e,sortKey:"Symbol",ascending:t},"Symbol"),n.createElement($,{sort:l,currentSortKey:e,sortKey:"Current price",ascending:t},"Price"),n.createElement($,{sort:l,currentSortKey:e,sortKey:"Total value",ascending:t},"Total value"),n.createElement($,{sort:l,currentSortKey:e,sortKey:"Total shares",ascending:t},"Shares"),n.createElement($,{sort:l,currentSortKey:e,sortKey:"Average price",ascending:t},"Avg price"),n.createElement($,{sort:l,currentSortKey:e,sortKey:"Gain",ascending:t},"Gain"),n.createElement($,{sort:l,currentSortKey:e,sortKey:"Gain percentage",ascending:t},"Percentage"))},V=()=>n.createElement("div",{className:"flex justify-between p-4"},n.createElement(N,null),n.createElement(O,null)),$=({sort:e,children:t,currentSortKey:a,sortKey:r,ascending:l})=>n.createElement("th",null,n.createElement("button",{onClick:e(r),className:"whitespace-nowrap rounded-sm ring-red-800 focus:ring-1 dark:ring-red-600"},t,r===a&&n.createElement(j,{ascending:l}))),j=({ascending:e})=>n.createElement(n.Fragment,null,e?n.createElement(s.lmx,{className:"inline"}):n.createElement(s.Gal,{className:"inline"}));var F=a(447),Y=a(6535);let q=()=>n.createElement(n.Fragment,null,n.createElement(F.Z,{title:"Stocks"}),n.createElement(Y.Z,null,n.createElement(R,null)));var Z=q},447:function(e,t,a){"use strict";var r=a(9008),n=a.n(r),l=a(7294);let s=({title:e})=>{let t=`${e} | Finance`;return l.createElement(n(),null,l.createElement("title",null,t))};t.Z=s},7538:function(e,t,a){"use strict";a.d(t,{ft:function(){return c},h_:function(){return i},ku:function(){return u},t1:function(){return d},xh:function(){return s}});var r=a(8100),n=a(7294),l=a(3747);let s=!1,o=l.yG?"https://localhost:5001":"https://finance.oliverflecke.me",c=`${o}/api/v1`;function i(e,t,a){let{getAccessTokenSilently:s}=(0,r.D3)(),[o,c]=(0,n.useState)({loading:!0});return(0,n.useEffect)(()=>{(async()=>{try{console.log("Getting access token");let r=await s();console.log(`Token: ${r}`);let n=await fetch(e,{...t,mode:l.yG?"cors":"no-cors",headers:{...t?.headers,Authorization:`Bearer ${r}`}}),i=await n.json();c({...o,data:a?a(i):i,error:void 0,loading:!1})}catch(u){c({...o,error:u,loading:!1})}})()},[]),o}function u(e,t){let{getAccessTokenSilently:a}=(0,r.D3)();return(0,n.useCallback)(async r=>{try{let n=await a();return await fetch(e,{...t,mode:l.yG?"cors":"no-cors",body:r?JSON.stringify(r):void 0,headers:{"Content-Type":"application/json",...t?.headers,Authorization:`Bearer ${n}`}})}catch(s){console.error(s);return}},[a,t,e])}function d(){let{getAccessTokenSilently:e}=(0,r.D3)();return(0,n.useCallback)(async(t,a,r)=>{try{let n=await e();return await fetch(t,{...a,mode:l.yG?"cors":"no-cors",body:r?JSON.stringify(r):void 0,headers:{"Content-Type":"application/json",...a?.headers,Authorization:`Bearer ${n}`}})}catch(s){console.error(s);return}},[e])}},1635:function(e,t,a){"use strict";function r(e){return e>0?n.positiveColor:e<0?n.negativeColor:""}a.d(t,{y:function(){return r}});let n={positiveColor:"text-green-700 dark:text-green-500",negativeColor:"text-red-700 dark:text-red-500"}},515:function(e,t,a){"use strict";a.d(t,{CV:function(){return i},fK:function(){return s},p3:function(){return n},sL:function(){return c},xG:function(){return l}});var r=a(7294);function n(e){return Number.parseFloat(e.toString().replace(/[,a-zA-Z]/g,""))}function l(e,t){if(!e||Number.isNaN(e))return"0";let a=t=>e.toLocaleString("en-US",{style:"currency",currency:t,currencyDisplay:"symbol"});try{return a(t??"USD")}catch(r){if(r instanceof RangeError&&r.message.startsWith("Invalid currency code")&&t)return a("USD").replace("USD",t);return e.toString()}}function s(e,t,a,r){return e*o(t,a,r)}function o(e,t,a){let r=t?.toLowerCase(),n=a?.toLowerCase();return r&&n&&r!==n?"usd"===r?"GBp"===a?100*e.gbp:n in e?e[n]:1:"usd"!==n?o(e,t,"usd")*o(e,"usd",a):"GBp"===t?1/(100*e.gbp):r in e?1/e[r]:1:1}function c(e,t,a){return(0,r.useCallback)(r=>r*o(a,e,t),[e,a,t])}function i(e){return Object.keys(e).sort().reduce((t,a)=>(t[a]=e[a],t),{})}Intl.NumberFormat(void 0,{style:"currency",currency:"DKK",currencyDisplay:"code"})},6645:function(e,t,a){"use strict";function r(e){let t=e.getFullYear(),a=""+(e.getMonth()+1),r=""+e.getDate();return a.length<2&&(a="0"+a),r.length<2&&(r="0"+r),[t,a,r].join("-")}a.d(t,{p:function(){return r}})},3747:function(e,t,a){"use strict";function r(e){return Object.keys(e).every(t=>void 0!==e[t])}a.d(t,{vZ:function(){return r},yG:function(){return n}});let n=!1},2308:function(e,t,a){"use strict";function r(...e){return e.reduce((e,t)=>e+t,0)}a.d(t,{S:function(){return r}})},2337:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/stocks",function(){return a(1365)}])}},function(e){e.O(0,[536,888,774,179],function(){return e(e.s=2337)}),_N_E=e.O()}]);